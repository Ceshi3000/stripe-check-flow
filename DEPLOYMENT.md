# Stripe æ”¯ä»˜ç³»ç»Ÿæç®€éƒ¨ç½²æŒ‡å—ï¼ˆå®å¡”é¢æ¿ç‰ˆï¼‰

æœ¬æŒ‡å—è¯¦ç»†è¯´æ˜å¦‚ä½•ä½¿ç”¨å®å¡”é¢æ¿ï¼Œåœ¨æ‚¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šéƒ¨ç½²æ•´ä¸ª Stripe æ”¯ä»˜ç³»ç»Ÿï¼ˆå‰åç«¯åˆ†ç¦»æ¶æ„ï¼‰ã€‚

**âœ¨ æœ¬ç³»ç»Ÿå®Œå…¨ç‹¬ç«‹ï¼Œä¸ä¾èµ–ä»»ä½•ç¬¬ä¸‰æ–¹æ•°æ®åº“æœåŠ¡ï¼**

---

## ğŸ“ é›¶ã€æ›´æ”¹å…¬å¸åç§°æ•™ç¨‹ï¼ˆéƒ¨ç½²å‰å¿…è¯»ï¼‰

å¦‚æœæ‚¨éœ€è¦å°†é»˜è®¤çš„å…¬å¸åç§° `Apa High Income Opportunity Fund, L.p.` æ›´æ”¹ä¸ºæ‚¨è‡ªå·±çš„å…¬å¸åç§°ï¼ˆå¦‚ `AABBCC.LLC`ï¼‰ï¼Œè¯·åœ¨éƒ¨ç½²å‰æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤ä¿®æ”¹ä»£ç ï¼š

### éœ€è¦ä¿®æ”¹çš„æ–‡ä»¶æ¸…å•

**âš ï¸ é‡è¦æç¤º**ï¼š
- ä»¥ä¸‹æ‰€æœ‰æ–‡ä»¶éƒ½éœ€è¦åœ¨**æœ¬åœ°å¼€å‘ç¯å¢ƒ**ä¸­ä¿®æ”¹
- ä¿®æ”¹å®Œæˆåï¼Œéœ€è¦é‡æ–°æ‰§è¡Œ `npm run build` æ„å»ºå‰ç«¯
- ç„¶åå°†æ„å»ºåçš„ `dist` ç›®å½•å’Œåç«¯æ–‡ä»¶ä¸Šä¼ åˆ°æœåŠ¡å™¨

---

#### æ–‡ä»¶1ï¼š`api/package.json`

**ä½ç½®**ï¼šç¬¬ 4 è¡Œ  
**åŸå†…å®¹**ï¼š
```json
"description": "Express API for Apa High Income Opportunity Fund payment processing",
```

**ä¿®æ”¹ä¸º**ï¼š
```json
"description": "Express API for AABBCC.LLC payment processing",
```

---

#### æ–‡ä»¶2ï¼š`api/server.js`

**ä½ç½®1**ï¼šç¬¬ 54 è¡Œ **ã€âœ¨ é‡è¦ - Stripe è®¢å•æè¿°ï¼Œæ˜¾ç¤ºåœ¨ Stripe åå°å’Œç”¨æˆ·è´¦å•ä¸­ã€‘**  
**åŸå†…å®¹**ï¼š
```javascript
description: 'Apa High Income Opportunity Fund, L.p.',
```

**ä¿®æ”¹ä¸º**ï¼š
```javascript
description: 'AABBCC.LLC',
```

**ä½ç½®2**ï¼šç¬¬ 56 è¡Œ  
**åŸå†…å®¹**ï¼š
```javascript
company: 'Apa High Income Opportunity Fund, L.p.',
```

**ä¿®æ”¹ä¸º**ï¼š
```javascript
company: 'AABBCC.LLC',
```

---

#### æ–‡ä»¶3ï¼š`index.html`

**ä½ç½®1**ï¼šç¬¬ 6 è¡Œ  
**åŸå†…å®¹**ï¼š
```html
<title>Secure Payment Portal - Apa High Income Opportunity Fund, L.p.</title>
```

**ä¿®æ”¹ä¸º**ï¼š
```html
<title>Secure Payment Portal - AABBCC.LLC</title>
```

**ä½ç½®2**ï¼šç¬¬ 7 è¡Œ  
**åŸå†…å®¹**ï¼š
```html
<meta name="description" content="Secure payment portal for Apa High Income Opportunity Fund, L.p. Make payments according to your quoted solution price or discussed pricing plan." />
```

**ä¿®æ”¹ä¸º**ï¼š
```html
<meta name="description" content="Secure payment portal for AABBCC.LLC. Make payments according to your quoted solution price or discussed pricing plan." />
```

**ä½ç½®3**ï¼šç¬¬ 8 è¡Œ  
**åŸå†…å®¹**ï¼š
```html
<meta name="author" content="Apa High Income Opportunity Fund, L.p." />
```

**ä¿®æ”¹ä¸º**ï¼š
```html
<meta name="author" content="AABBCC.LLC" />
```

**ä½ç½®4**ï¼šç¬¬ 10 è¡Œ  
**åŸå†…å®¹**ï¼š
```html
<meta property="og:title" content="Secure Payment Portal - Apa High Income Opportunity Fund, L.p." />
```

**ä¿®æ”¹ä¸º**ï¼š
```html
<meta property="og:title" content="Secure Payment Portal - AABBCC.LLC" />
```

**ä½ç½®5**ï¼šç¬¬ 11 è¡Œ  
**åŸå†…å®¹**ï¼š
```html
<meta property="og:description" content="Secure payment portal for Apa High Income Opportunity Fund, L.p. services" />
```

**ä¿®æ”¹ä¸º**ï¼š
```html
<meta property="og:description" content="Secure payment portal for AABBCC.LLC services" />
```

---

#### æ–‡ä»¶4ï¼š`src/components/PaymentForm.tsx`

**ä½ç½®**ï¼šç¬¬ 38 è¡Œ  
**åŸå†…å®¹**ï¼š
```tsx
<h1 className="text-2xl font-bold text-foreground">Apa High Income Opportunity Fund, L.p.</h1>
```

**ä¿®æ”¹ä¸º**ï¼š
```tsx
<h1 className="text-2xl font-bold text-foreground">AABBCC.LLC</h1>
```

---

#### æ–‡ä»¶5ï¼š`src/components/PaymentFormContent.tsx`

**ä½ç½®**ï¼šç¬¬ 171 è¡Œ  
**åŸå†…å®¹**ï¼š
```tsx
<h1 className="text-2xl font-bold text-foreground">Apa High Income Opportunity Fund, L.p.</h1>
```

**ä¿®æ”¹ä¸º**ï¼š
```tsx
<h1 className="text-2xl font-bold text-foreground">AABBCC.LLC</h1>
```

---

### ä¿®æ”¹å®Œæˆåçš„æ“ä½œæµç¨‹

1. **æ£€æŸ¥æ‰€æœ‰æ–‡ä»¶**ï¼šç¡®è®¤ä»¥ä¸Š 5 ä¸ªæ–‡ä»¶çš„æ‰€æœ‰ä½ç½®éƒ½å·²ä¿®æ”¹å®Œæˆ
2. **é‡æ–°æ„å»ºå‰ç«¯**ï¼š
   ```bash
   npm run build
   ```
3. **ä¸Šä¼ æ–‡ä»¶åˆ°æœåŠ¡å™¨**ï¼š
   - å°† `dist/` ç›®å½•å†…å®¹ä¸Šä¼ åˆ°å‰ç«¯ç½‘ç«™æ ¹ç›®å½•ï¼ˆè¦†ç›–æ—§æ–‡ä»¶ï¼‰
   - å°† `api/server.js` å’Œ `api/package.json` ä¸Šä¼ åˆ°åç«¯ç›®å½•ï¼ˆè¦†ç›–æ—§æ–‡ä»¶ï¼‰
4. **é‡å¯åç«¯æœåŠ¡**ï¼šåœ¨å®å¡” Node é¡¹ç›®ç®¡ç†å™¨ä¸­é‡å¯åç«¯é¡¹ç›®
5. **æµ‹è¯•éªŒè¯**ï¼šè®¿é—®å‰ç«¯ç½‘ç«™ï¼Œç¡®è®¤å…¬å¸åç§°å·²æ›´æ–°

---

**æœ¬æ–¹æ¡ˆç‰¹ç‚¹ï¼š**
- âœ… æ— éœ€æ•°æ®åº“é…ç½®
- âœ… åç«¯æ— çŠ¶æ€ï¼Œä»…è°ƒç”¨ Stripe API
- âœ… æ‰€æœ‰æ”¯ä»˜è®°å½•å­˜å‚¨åœ¨ Stripe åå°
- âœ… æç®€éƒ¨ç½²ï¼Œé€‚åˆå®å¡”é¢æ¿æ–°æ‰‹

## ç³»ç»Ÿæ¶æ„

```
æ‚¨çš„æœåŠ¡å™¨
â”œâ”€â”€ React å‰ç«¯é¡µé¢ï¼ˆç‹¬ç«‹ç½‘ç«™ï¼‰
â”‚   â””â”€â”€ æ”¯ä»˜è¡¨å•ç•Œé¢
â””â”€â”€ Node.js åç«¯ APIï¼ˆç‹¬ç«‹ç½‘ç«™/å­åŸŸåï¼‰
    â””â”€â”€ Stripe æ”¯ä»˜æ¥å£
```

---

## ğŸ”‘ ä¸€ã€Stripe å¯†é’¥é…ç½®ï¼ˆå¿…è¯»ï¼‰

### 1.1 è·å– Stripe å¯†é’¥

1. ç™»å½• [Stripe Dashboard](https://dashboard.stripe.com/)
2. åˆ‡æ¢åˆ°ã€Œæµ‹è¯•æ¨¡å¼ã€(Test mode)
3. å·¦ä¾§èœå•ï¼š**å¼€å‘è€… â†’ API å¯†é’¥**
4. è·å–ä¸¤ä¸ªå¯†é’¥ï¼š
   - **å…¬é’¥ (Publishable key)**ï¼š`pk_test_...`
   - **ç§é’¥ (Secret key)**ï¼š`sk_test_...`ï¼ˆç‚¹å‡»ã€Œæ˜¾ç¤ºã€æŸ¥çœ‹ï¼‰

### 1.2 å¯†é’¥é…ç½®ä½ç½®

| å¯†é’¥ç±»å‹ | é…ç½®æ–‡ä»¶ | ä½ç½® | ä½•æ—¶é…ç½® |
|---------|---------|------|---------|
| **å…¬é’¥** | `.env` | é¡¹ç›®æ ¹ç›®å½• | æ„å»ºå‰ç«¯å‰ |
| **ç§é’¥** | `api/.env` | åç«¯ç›®å½• | åç«¯éƒ¨ç½²æ—¶ |

### 1.3 å‰ç«¯ç¯å¢ƒå˜é‡é…ç½®ï¼ˆâš ï¸ å…³é”®æ­¥éª¤ï¼‰

åœ¨é¡¹ç›®æ ¹ç›®å½•çš„ `.env` æ–‡ä»¶ä¸­é…ç½®ä»¥ä¸‹å†…å®¹ï¼š

```bash
# é¡¹ç›®æ ¹ç›®å½•çš„ .env æ–‡ä»¶é…ç½®ç¤ºä¾‹
# æ³¨æ„ï¼šæ–‡ä»¶å·²å­˜åœ¨ï¼ŒåŒ…å« VITE_SUPABASE_* é…ç½®ï¼ˆä¸è¦åˆ é™¤ï¼‰
# ä½ åªéœ€è¦åœ¨æ–‡ä»¶æœ«å°¾è¿½åŠ ä»¥ä¸‹ä¸¤è¡Œï¼š

VITE_STRIPE_PUBLISHABLE_KEY=pk_test_ä½ çš„Stripeå…¬é’¥
VITE_API_URL=https://your-frontend-domain.com
```

âš ï¸ **VITE_API_URL é…ç½®è¯´æ˜ï¼ˆéå¸¸é‡è¦ï¼ï¼‰**ï¼š
- **å¿…é¡»å¡«å†™å‰ç«¯åŸŸå**ï¼Œè€Œä¸æ˜¯åç«¯åŸŸå
- å› ä¸ºå‰ç«¯é€šè¿‡ Nginx åå‘ä»£ç†è®¿é—®åç«¯ï¼Œæ‰€ä»¥ API åœ°å€å°±æ˜¯å‰ç«¯åŸŸå
- **é”™è¯¯ç¤ºä¾‹**ï¼š`VITE_API_URL=https://api.yourdomain.com:3002` âŒ
- **æ­£ç¡®ç¤ºä¾‹**ï¼š`VITE_API_URL=https://pay.yourdomain.com` âœ…
- æœ¬åœ°å¼€å‘æ—¶å¯ä»¥ç•™ç©ºï¼Œä¼šè‡ªåŠ¨ä½¿ç”¨ `http://localhost:3002`

### 1.4 API ç«¯å£é…ç½®ï¼ˆâš ï¸ å¿…é¡»æ£€æŸ¥ï¼‰

æ£€æŸ¥å¹¶ç¡®è®¤ `src/config/api.ts` æ–‡ä»¶ä¸­çš„ç«¯å£é…ç½®ï¼š

```typescript
// src/config/api.ts
export const API_BASE_URL = import.meta.env.VITE_API_URL || 'http://localhost:3002';
```

âš ï¸ **é‡è¦**ï¼š
- ç¡®è®¤ç«¯å£ä¸º `3002`ï¼ˆæˆ–ä½ å®é™…ä½¿ç”¨çš„ç«¯å£ï¼‰
- å¦‚æœç«¯å£ä¸åŒ¹é…ï¼Œä¼šå¯¼è‡´è¿æ¥å¤±è´¥
- æœ¬é¡¹ç›®é»˜è®¤ä½¿ç”¨ `3002` ç«¯å£

### 1.5 åç«¯ç¯å¢ƒå˜é‡é…ç½®

åœ¨å®å¡”åç«¯ç›®å½•åˆ›å»º `api/.env` æ–‡ä»¶ï¼š

```bash
# api/.env æ–‡ä»¶é…ç½®
STRIPE_SECRET_KEY=sk_test_ä½ çš„Stripeç§é’¥
PORT=3002
```

âš ï¸ **é‡è¦æç¤º**ï¼š
- `.env` æ–‡ä»¶ç”±ç³»ç»Ÿè‡ªåŠ¨åˆ›å»ºï¼ŒåŒ…å« `VITE_SUPABASE_*` é…ç½®ï¼ˆ**ä¸è¦åˆ é™¤**ï¼‰
- ä½ éœ€è¦åœ¨æ–‡ä»¶æœ«å°¾**è¿½åŠ ** Stripe å’Œ API é…ç½®
- `.env.example` åªæ˜¯é…ç½®æ¨¡æ¿ï¼Œç³»ç»Ÿä¸ä¼šè¯»å–å®ƒ
- **æ¯æ¬¡ä¿®æ”¹ `.env` æ–‡ä»¶åï¼Œå¿…é¡»é‡æ–°æ‰§è¡Œ `npm run build` æ„å»ºå‰ç«¯**
- å‰ç«¯æ˜¯é™æ€æ–‡ä»¶ï¼Œç¯å¢ƒå˜é‡åœ¨æ„å»ºæ—¶è¢«ç¼–è¯‘è¿›ä»£ç ï¼Œä¸ä¼šåŠ¨æ€è¯»å–

---

## äºŒã€å‡†å¤‡å·¥ä½œ

### 2.1 å®‰è£…å¿…è¦è½¯ä»¶

åœ¨å®å¡”é¢æ¿ä¸­å®‰è£…ï¼š
- **Node.js 18+**
- **PM2 ç®¡ç†å™¨**
- **Nginx**ï¼ˆé€šå¸¸å·²é¢„è£…ï¼‰

âš ï¸ **æ³¨æ„**ï¼šæœ¬æ–¹æ¡ˆ**ä¸éœ€è¦**å®‰è£… MySQL æ•°æ®åº“ã€‚

### 2.2 å‡†å¤‡åŸŸå

- **å‰ç«¯åŸŸå**ï¼ˆæ¨èï¼‰ï¼š`payment.yourdomain.com`
- **åç«¯APIåŸŸå**ï¼š`api-payment.yourdomain.com`
- å°†ä¸¤ä¸ªåŸŸåéƒ½è§£æåˆ°æ‚¨çš„æœåŠ¡å™¨ IP åœ°å€

---

## ä¸‰ã€å‰ç«¯éƒ¨ç½²ï¼ˆReactåº”ç”¨ï¼‰

### 3.1 é…ç½®ç¯å¢ƒå˜é‡å¹¶æ„å»ºå‰ç«¯

åœ¨æ‚¨çš„æœ¬åœ°å¼€å‘ç¯å¢ƒï¼ˆWindows/Macï¼‰æ‰§è¡Œï¼š

```bash
# è¿›å…¥é¡¹ç›®æ ¹ç›®å½•
cd /path/to/your/project

# 1. ç¼–è¾‘ .env æ–‡ä»¶ï¼ˆæ–‡ä»¶å·²å­˜åœ¨ï¼Œä¸éœ€è¦å¤åˆ¶ï¼‰
# åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ä»¥ä¸‹ä¸¤è¡Œï¼š
# VITE_STRIPE_PUBLISHABLE_KEY=pk_test_ä½ çš„Stripeå…¬é’¥
# VITE_API_URL=https://ä½ çš„å‰ç«¯åŸŸå.com

# 2. æ£€æŸ¥ src/config/api.ts æ–‡ä»¶
# ç¡®è®¤ç«¯å£é…ç½®ä¸º 3002ï¼š
# export const API_BASE_URL = import.meta.env.VITE_API_URL || 'http://localhost:3002';

# 3. å®‰è£…ä¾èµ–
npm install

# 4. æ„å»ºå‰ç«¯ç”Ÿäº§ç‰ˆæœ¬
npm run build
```

âš ï¸ **ç¯å¢ƒå˜é‡é…ç½®æ£€æŸ¥æ¸…å•**ï¼š
- [ ] `.env` æ–‡ä»¶ä¸­å·²æ·»åŠ  `VITE_STRIPE_PUBLISHABLE_KEY=pk_test_...`
- [ ] `.env` æ–‡ä»¶ä¸­å·²æ·»åŠ  `VITE_API_URL=https://ä½ çš„å‰ç«¯åŸŸå`ï¼ˆä¸æ˜¯åç«¯åŸŸåï¼‰
- [ ] `src/config/api.ts` ä¸­çš„ç«¯å£ä¸º `3002`
- [ ] å·²æ‰§è¡Œ `npm run build` æ„å»ºå‰ç«¯

âš ï¸ **é‡è¦æç¤º**ï¼š
- **æ¯æ¬¡ä¿®æ”¹ `.env` æ–‡ä»¶åï¼Œéƒ½å¿…é¡»é‡æ–°æ‰§è¡Œ `npm run build`**
- å‰ç«¯æ˜¯é™æ€æ–‡ä»¶ï¼Œç¯å¢ƒå˜é‡åœ¨æ„å»ºæ—¶è¢«ç¼–è¯‘è¿› JavaScript ä»£ç 
- ç›´æ¥ä¿®æ”¹æœåŠ¡å™¨ä¸Šçš„ `.env` æ–‡ä»¶ä¸ä¼šç”Ÿæ•ˆï¼Œå¿…é¡»æœ¬åœ°æ„å»ºåé‡æ–°ä¸Šä¼ 
- æ„å»ºå®Œæˆåï¼Œä¼šç”Ÿæˆ `dist/` ç›®å½•ï¼ŒåŒ…å«æ‰€æœ‰å‰ç«¯é™æ€æ–‡ä»¶

### 3.2 æ–¹æ³•Aï¼šä¸Šä¼ åˆ°å·²æœ‰ç½‘ç«™ï¼ˆè¦†ç›–ï¼‰

å¦‚æœæ‚¨å·²ç»æœ‰ä¸€ä¸ªç½‘ç«™ï¼Œæƒ³å°†æ”¯ä»˜é¡µé¢éƒ¨ç½²åˆ°è¿™ä¸ªç½‘ç«™çš„æ ¹ç›®å½•ï¼š

1. ç™»å½•å®å¡”é¢æ¿ï¼Œç‚¹å‡»å·¦ä¾§èœå• **"ç½‘ç«™"**
2. æ‰¾åˆ°ç›®æ ‡ç½‘ç«™ï¼Œç‚¹å‡» **"æ ¹ç›®å½•"** åˆ—çš„è·¯å¾„ï¼ˆå¦‚ `/www/wwwroot/yourdomain.com`ï¼‰
3. è¿›å…¥æ–‡ä»¶ç®¡ç†å™¨åï¼Œ**åˆ é™¤**æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰æ—§æ–‡ä»¶
4. å°†æœ¬åœ° `dist/` ç›®å½•ä¸‹çš„**æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹**ä¸Šä¼ åˆ°è¿™ä¸ªæ ¹ç›®å½•
5. æœ€ç»ˆç›®å½•ç»“æ„ï¼š
   ```
   /www/wwwroot/yourdomain.com/
   â”œâ”€â”€ index.html
   â”œâ”€â”€ assets/
   â”‚   â”œâ”€â”€ index-xxx.js
   â”‚   â””â”€â”€ index-xxx.css
   â””â”€â”€ ...
   ```

### 3.3 æ–¹æ³•Bï¼šåˆ›å»ºæ–°ç½‘ç«™ï¼ˆæ¨èï¼‰

ä¸ºå‰ç«¯åº”ç”¨åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„ç½‘ç«™ï¼š

#### æ­¥éª¤ 1ï¼šæ·»åŠ ç«™ç‚¹

1. ç™»å½•å®å¡”é¢æ¿ï¼Œç‚¹å‡»å·¦ä¾§èœå• **"ç½‘ç«™"**
2. ç‚¹å‡» **"æ·»åŠ ç«™ç‚¹"**
3. å¡«å†™ä¿¡æ¯ï¼š
   - **åŸŸå**ï¼š`payment.yourdomain.com`
   - **æ ¹ç›®å½•**ï¼š`/www/wwwroot/payment.yourdomain.com`
   - **FTP**ï¼šä¸åˆ›å»º
   - **æ•°æ®åº“**ï¼šä¸åˆ›å»º
   - **PHPç‰ˆæœ¬**ï¼šçº¯é™æ€
4. ç‚¹å‡» **"æäº¤"**

#### æ­¥éª¤ 2ï¼šä¸Šä¼ å‰ç«¯æ–‡ä»¶

1. åœ¨ç½‘ç«™åˆ—è¡¨ä¸­ï¼Œç‚¹å‡»åˆšåˆ›å»ºçš„ç«™ç‚¹çš„ **"æ ¹ç›®å½•"** è·¯å¾„
2. è¿›å…¥ `/www/wwwroot/payment.yourdomain.com/` ç›®å½•
3. **åˆ é™¤**å®å¡”è‡ªåŠ¨ç”Ÿæˆçš„ç¤ºä¾‹æ–‡ä»¶ï¼ˆå¦‚ `index.html`ï¼‰
4. å°†æœ¬åœ° `dist/` ç›®å½•ä¸‹çš„**æ‰€æœ‰æ–‡ä»¶å’Œæ–‡ä»¶å¤¹**ä¸Šä¼ åˆ°è¿™é‡Œ
5. æœ€ç»ˆç›®å½•ç»“æ„ï¼š
   ```
   /www/wwwroot/payment.yourdomain.com/
   â”œâ”€â”€ index.html
   â”œâ”€â”€ assets/
   â”‚   â”œâ”€â”€ index-xxx.js
   â”‚   â””â”€â”€ index-xxx.css
   â””â”€â”€ ...
   ```

#### æ­¥éª¤ 3ï¼šé…ç½® SSL è¯ä¹¦ï¼ˆå¼ºçƒˆæ¨èï¼‰

1. åœ¨ç½‘ç«™åˆ—è¡¨ä¸­ï¼Œç‚¹å‡»ç«™ç‚¹çš„ **"è®¾ç½®"**
2. ç‚¹å‡» **"SSL"** æ ‡ç­¾
3. é€‰æ‹© **"Let's Encrypt"**
4. å‹¾é€‰æ‚¨çš„åŸŸåï¼Œç‚¹å‡» **"ç”³è¯·"**
5. å¯ç”¨ **"å¼ºåˆ¶HTTPS"**

#### æ­¥éª¤ 4ï¼šé…ç½® Nginx åå‘ä»£ç†ï¼ˆè¿æ¥åç«¯APIï¼‰

1. åœ¨ç«™ç‚¹è®¾ç½®ä¸­ï¼Œç‚¹å‡» **"é…ç½®æ–‡ä»¶"** æ ‡ç­¾
2. æ‰¾åˆ° `server` å—ï¼Œåœ¨ `location /` ä¹‹å‰æ·»åŠ ï¼š

```nginx
# åå‘ä»£ç† API è¯·æ±‚åˆ°åç«¯
location /api {
    proxy_pass http://127.0.0.1:3002;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection 'upgrade';
    proxy_set_header Host $host;
    proxy_set_header X-Real-IP $remote_addr;
    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    proxy_cache_bypass $http_upgrade;
}

# å¥åº·æ£€æŸ¥
location /health {
    proxy_pass http://127.0.0.1:3002;
    proxy_http_version 1.1;
}
```

3. ä¿å­˜é…ç½®å¹¶é‡è½½ Nginx

---

## å››ã€åç«¯éƒ¨ç½²ï¼ˆNode.js APIï¼‰

### 4.1 åˆ›å»ºåç«¯é¡¹ç›®ç›®å½•

1. åœ¨å®å¡”é¢æ¿å·¦ä¾§èœå•ç‚¹å‡» **"æ–‡ä»¶"**
2. è¿›å…¥ `/www/wwwroot/` ç›®å½•
3. ç‚¹å‡» **"æ–°å»ºç›®å½•"**ï¼Œåˆ›å»º `stripe-payment-api`
4. è¿›å…¥ `/www/wwwroot/stripe-payment-api/` ç›®å½•

### 4.2 ä¸Šä¼ åç«¯æ–‡ä»¶

å°†é¡¹ç›®ä¸­çš„ä»¥ä¸‹æ–‡ä»¶ä¸Šä¼ åˆ° `/www/wwwroot/stripe-payment-api/`ï¼š

```
stripe-payment-api/
â”œâ”€â”€ server.js          # åç«¯ä¸»æ–‡ä»¶ï¼ˆä» api/server.js ä¸Šä¼ ï¼‰
â”œâ”€â”€ package.json       # ä¾èµ–é…ç½®ï¼ˆä» api/package.json ä¸Šä¼ ï¼‰
â””â”€â”€ .env              # ç¯å¢ƒå˜é‡ï¼ˆç¨ååˆ›å»ºï¼‰
```

**ä¸Šä¼ æ–¹å¼**ï¼š
- ç‚¹å‡»å®å¡”æ–‡ä»¶ç®¡ç†å™¨çš„ **"ä¸Šä¼ "** æŒ‰é’®
- æˆ–ä½¿ç”¨ SFTP å·¥å…·ï¼ˆå¦‚ FileZillaï¼‰ä¸Šä¼ 

### 4.3 é…ç½®ç¯å¢ƒå˜é‡

1. åœ¨ `/www/wwwroot/stripe-payment-api/` ç›®å½•ï¼Œç‚¹å‡» **"æ–°å»ºæ–‡ä»¶"**
2. æ–‡ä»¶åï¼š`.env`
3. å¡«å†™ä»¥ä¸‹å†…å®¹ï¼š

```env
# Stripe å¯†é’¥ï¼ˆå¿…å¡«ï¼‰
STRIPE_SECRET_KEY=sk_test_ä½ çš„Stripeæµ‹è¯•å¯†é’¥

# æœåŠ¡å™¨ç«¯å£ï¼ˆå¿…å¡«ï¼‰
PORT=3002
```

âš ï¸ **é‡è¦**ï¼š
- **æµ‹è¯•ç¯å¢ƒ**ä½¿ç”¨ `sk_test_...` å¼€å¤´çš„å¯†é’¥
- **ç”Ÿäº§ç¯å¢ƒ**ä½¿ç”¨ `sk_live_...` å¼€å¤´çš„å¯†é’¥
- ç¡®ä¿ `.env` æ–‡ä»¶æƒé™è®¾ç½®ä¸º **600** æˆ– **644**

### 4.4 ä½¿ç”¨å®å¡” Node.js ç®¡ç†å™¨éƒ¨ç½²

#### æ­¥éª¤ 1ï¼šå®‰è£… Node é¡¹ç›®ç®¡ç†å™¨

1. åœ¨å®å¡”é¢æ¿å·¦ä¾§èœå•ç‚¹å‡» **"è½¯ä»¶å•†åº—"**
2. æœç´¢ **"Node é¡¹ç›®ç®¡ç†å™¨"**ï¼Œç‚¹å‡» **"å®‰è£…"**ï¼ˆå¦‚å·²å®‰è£…åˆ™è·³è¿‡ï¼‰

#### æ­¥éª¤ 2ï¼šæ·»åŠ  Node é¡¹ç›®

1. å®‰è£…å®Œæˆåï¼Œç‚¹å‡»å·¦ä¾§èœå•çš„ **"Nodeé¡¹ç›®"**
2. ç‚¹å‡» **"æ·»åŠ Nodeé¡¹ç›®"**
3. å¡«å†™é…ç½®ï¼š
   - **é¡¹ç›®åç§°**ï¼š`stripe-payment-api`
   - **é¡¹ç›®è·¯å¾„**ï¼š`/www/wwwroot/stripe-payment-api`
   - **æ‰§è¡Œæ–‡ä»¶**ï¼š`server.js`
   - **å¯åŠ¨ç«¯å£**ï¼š`3002`ï¼ˆä¸ `.env` ä¸­çš„ `PORT` ä¸€è‡´ï¼‰
   - **Node ç‰ˆæœ¬**ï¼šé€‰æ‹© **18.x** æˆ–æ›´é«˜
   - **è¿è¡Œç”¨æˆ·**ï¼š`www`
   - **å¯åŠ¨æ–¹å¼**ï¼š`PM2`
4. ç‚¹å‡» **"æäº¤"**

#### æ­¥éª¤ 3ï¼šè‡ªåŠ¨å®‰è£…ä¾èµ–

å®å¡”ä¼šè‡ªåŠ¨æ‰§è¡Œ `npm install` å®‰è£…ä¾èµ–ï¼Œæ­¤è¿‡ç¨‹éœ€è¦ 1-2 åˆ†é’Ÿã€‚

#### æ­¥éª¤ 4ï¼šéªŒè¯é¡¹ç›®çŠ¶æ€

- åœ¨ Node é¡¹ç›®åˆ—è¡¨ä¸­ï¼Œç¡®è®¤é¡¹ç›®çŠ¶æ€ä¸º **"è¿è¡Œä¸­"**ï¼ˆç»¿è‰²ï¼‰
- ç‚¹å‡» **"æ—¥å¿—"** æŸ¥çœ‹å¯åŠ¨ä¿¡æ¯ï¼Œåº”çœ‹åˆ°ï¼š
  ```
  âœ… Payment API Server running on port 3002
  ğŸ“ Health check: http://localhost:3002/health
  ```

### 4.5 é…ç½®åç«¯ API ç‹¬ç«‹åŸŸåï¼ˆå¯é€‰ä½†æ¨èï¼‰

å¦‚æœæ‚¨å¸Œæœ›ä¸ºåç«¯ API é…ç½®ç‹¬ç«‹çš„åŸŸåï¼ˆå¦‚ `api-payment.yourdomain.com`ï¼‰ï¼š

#### æ­¥éª¤ 1ï¼šæ·»åŠ ç«™ç‚¹

1. åœ¨å®å¡”é¢æ¿ç‚¹å‡» **"ç½‘ç«™"** -> **"æ·»åŠ ç«™ç‚¹"**
2. å¡«å†™ä¿¡æ¯ï¼š
   - **åŸŸå**ï¼š`api-payment.yourdomain.com`
   - **æ ¹ç›®å½•**ï¼š`/www/wwwroot/api-payment.yourdomain.com`ï¼ˆä»»æ„ï¼Œå› ä¸ºä¼šåå‘ä»£ç†ï¼‰
   - **PHPç‰ˆæœ¬**ï¼šçº¯é™æ€
3. ç‚¹å‡» **"æäº¤"**

#### æ­¥éª¤ 2ï¼šé…ç½®åå‘ä»£ç†

1. åœ¨ç½‘ç«™åˆ—è¡¨ä¸­ï¼Œç‚¹å‡» `api-payment.yourdomain.com` çš„ **"è®¾ç½®"**
2. ç‚¹å‡» **"åå‘ä»£ç†"** æ ‡ç­¾
3. ç‚¹å‡» **"æ·»åŠ åå‘ä»£ç†"**
4. å¡«å†™ï¼š
   - **ä»£ç†åç§°**ï¼š`stripe-api`
   - **ç›®æ ‡URL**ï¼š`http://127.0.0.1:3002`
   - **å‘é€åŸŸå**ï¼š`$host`
5. ä¿å­˜é…ç½®

#### æ­¥éª¤ 3ï¼šç”³è¯· SSL è¯ä¹¦

1. åœ¨ç«™ç‚¹è®¾ç½®ä¸­ï¼Œç‚¹å‡» **"SSL"** æ ‡ç­¾
2. ç”³è¯· Let's Encrypt è¯ä¹¦
3. å¯ç”¨ **"å¼ºåˆ¶HTTPS"**

---

## äº”ã€æµ‹è¯•éªŒè¯

### 5.1 æµ‹è¯•åç«¯ API

æµè§ˆå™¨è®¿é—®ï¼š
```
https://payment.yourdomain.com/health
```
æˆ–ï¼ˆå¦‚æœé…ç½®äº†ç‹¬ç«‹APIåŸŸåï¼‰ï¼š
```
https://api-payment.yourdomain.com/health
```

åº”è¿”å›ï¼š
```json
{
  "status": "ok",
  "timestamp": "2025-01-XX..."
}
```

### 5.2 æµ‹è¯•å‰ç«¯æ”¯ä»˜é¡µé¢

æµè§ˆå™¨è®¿é—®ï¼š
```
https://payment.yourdomain.com
```

åº”æ˜¾ç¤ºå®Œæ•´çš„æ”¯ä»˜è¡¨å•ç•Œé¢ã€‚

### 5.3 æµ‹è¯•å®Œæ•´æ”¯ä»˜æµç¨‹

1. åœ¨æ”¯ä»˜é¡µé¢è¾“å…¥é‡‘é¢ï¼ˆå¦‚ `100`ï¼‰
2. ä½¿ç”¨ Stripe æµ‹è¯•å¡å·ï¼š
   - **å¡å·**ï¼š`4242 4242 4242 4242`
   - **æœ‰æ•ˆæœŸ**ï¼šä»»æ„æœªæ¥æ—¥æœŸï¼ˆå¦‚ `12/34`ï¼‰
   - **CVC**ï¼šä»»æ„ 3 ä½æ•°å­—ï¼ˆå¦‚ `123`ï¼‰
   - **é‚®ç¼–**ï¼šä»»æ„ 5 ä½æ•°å­—ï¼ˆå¦‚ `12345`ï¼‰
3. å¡«å†™è´¦å•ä¿¡æ¯ï¼Œç‚¹å‡» **"ç«‹å³æ”¯ä»˜"**
4. æ”¯ä»˜æˆåŠŸåï¼Œå‰å¾€ [Stripe Dashboard](https://dashboard.stripe.com/test/payments) æŸ¥çœ‹æ”¯ä»˜è®°å½•

---

## å…­ã€æ›´æ–°ä»£ç æµç¨‹

### 6.1 æ›´æ–°åç«¯ä»£ç 

1. ä¿®æ”¹æœ¬åœ°çš„ `api/server.js` æˆ– `api/package.json`
2. é€šè¿‡å®å¡”æ–‡ä»¶ç®¡ç†å™¨ä¸Šä¼ æ›¿æ¢æ–‡ä»¶
3. åœ¨ **"Nodeé¡¹ç›®"** ä¸­ï¼Œç‚¹å‡»é¡¹ç›®çš„ **"é‡å¯"** æŒ‰é’®

### 6.2 æ›´æ–°å‰ç«¯ä»£ç 

1. æœ¬åœ°ä¿®æ”¹å‰ç«¯ä»£ç åï¼Œé‡æ–°æ„å»ºï¼š
   ```bash
   npm run build
   ```
2. å°†æ–°çš„ `dist/` ç›®å½•å†…å®¹ä¸Šä¼ åˆ°å‰ç«¯ç½‘ç«™çš„æ ¹ç›®å½•ï¼Œè¦†ç›–æ—§æ–‡ä»¶
3. å‰ç«¯é™æ€æ–‡ä»¶æ— éœ€é‡å¯æœåŠ¡ï¼Œåˆ·æ–°æµè§ˆå™¨å³å¯çœ‹åˆ°æ›´æ–°

---

## ä¸ƒã€å¸¸è§é—®é¢˜æ’æŸ¥

### 7.1 Node é¡¹ç›®å¯åŠ¨å¤±è´¥

**é—®é¢˜**ï¼šåœ¨ Node é¡¹ç›®åˆ—è¡¨ä¸­æ˜¾ç¤º **"å·²åœæ­¢"** æˆ–é”™è¯¯çŠ¶æ€

**æ’æŸ¥æ­¥éª¤**ï¼š
1. ç‚¹å‡» **"æ—¥å¿—"** æŸ¥çœ‹é”™è¯¯ä¿¡æ¯
2. å¸¸è§åŸå› ï¼š
   - **ç«¯å£å ç”¨**ï¼šç¡®è®¤ 3002 ç«¯å£æœªè¢«å ç”¨
   - **ç¯å¢ƒå˜é‡é”™è¯¯**ï¼šæ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„ `STRIPE_SECRET_KEY` æ˜¯å¦æ­£ç¡®
   - **ä¾èµ–æœªå®‰è£…**ï¼šæ‰‹åŠ¨è¿›å…¥é¡¹ç›®ç›®å½•æ‰§è¡Œ `npm install`
3. ä¿®å¤é—®é¢˜åï¼Œç‚¹å‡» **"é‡å¯"**

### 7.2 è®¿é—®ç½‘ç«™æ˜¾ç¤º 502 é”™è¯¯

**é—®é¢˜**ï¼šæµè§ˆå™¨æ˜¾ç¤º `502 Bad Gateway`

**åŸå› **ï¼šNode.js åç«¯æœªå¯åŠ¨ï¼Œæˆ– Nginx åå‘ä»£ç†é…ç½®é”™è¯¯

**è§£å†³æ–¹æ³•**ï¼š
1. ç¡®è®¤ Node é¡¹ç›®çŠ¶æ€ä¸º **"è¿è¡Œä¸­"**
2. æ£€æŸ¥ Nginx é…ç½®ä¸­çš„ `proxy_pass` ç«¯å£æ˜¯å¦ä¸º `3002`
3. é‡è½½ Nginx é…ç½®

### 7.3 å‰ç«¯æ”¯ä»˜æ—¶æç¤ºç½‘ç»œé”™è¯¯ / ERR_CONNECTION_RESET

**é—®é¢˜**ï¼šå‰ç«¯é¡µé¢æ— æ³•è°ƒç”¨åç«¯ APIï¼Œæµè§ˆå™¨æ§åˆ¶å°æ˜¾ç¤º `Failed to fetch` æˆ– `ERR_CONNECTION_RESET`

**å¸¸è§åŸå› åŠè§£å†³æ–¹æ³•**ï¼š

**åŸå› 1ï¼šç¯å¢ƒå˜é‡é…ç½®é”™è¯¯**
- æ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„ `VITE_API_URL` æ˜¯å¦å¡«å†™æ­£ç¡®
- **å¿…é¡»å¡«å†™å‰ç«¯åŸŸå**ï¼Œè€Œä¸æ˜¯åç«¯åŸŸå
- é”™è¯¯ç¤ºä¾‹ï¼š`VITE_API_URL=https://api.yourdomain.com:3002` âŒ
- æ­£ç¡®ç¤ºä¾‹ï¼š`VITE_API_URL=https://pay.yourdomain.com` âœ…
- ä¿®æ”¹åå¿…é¡»é‡æ–°æ‰§è¡Œ `npm run build` å¹¶é‡æ–°ä¸Šä¼  `dist` ç›®å½•

**åŸå› 2ï¼šAPI ç«¯å£é…ç½®ä¸åŒ¹é…**
- æ£€æŸ¥ `src/config/api.ts` æ–‡ä»¶ä¸­çš„ç«¯å£é…ç½®
- ç¡®è®¤ä¸ºï¼š`export const API_BASE_URL = import.meta.env.VITE_API_URL || 'http://localhost:3002';`
- ç«¯å£å¿…é¡»ä¸åç«¯ `.env` æ–‡ä»¶ä¸­çš„ `PORT` ä¸€è‡´
- ä¿®æ”¹åå¿…é¡»é‡æ–°æ‰§è¡Œ `npm run build` å¹¶é‡æ–°ä¸Šä¼  `dist` ç›®å½•

**åŸå› 3ï¼šæœªé‡æ–°æ„å»ºå‰ç«¯**
- æ¯æ¬¡ä¿®æ”¹ `.env` æˆ– `src/config/api.ts` åï¼Œå¿…é¡»é‡æ–°æ„å»º
- æ‰§è¡Œï¼š`npm run build`
- å°†æ–°ç”Ÿæˆçš„ `dist` ç›®å½•å†…å®¹é‡æ–°ä¸Šä¼ åˆ°æœåŠ¡å™¨

**åŸå› 4ï¼šNginx åå‘ä»£ç†æœªæ­£ç¡®é…ç½®**
- ç¡®è®¤å‰ç«¯ç½‘ç«™çš„ Nginx é…ç½®ä¸­å·²æ·»åŠ  `/api` å’Œ `/health` çš„åå‘ä»£ç†è§„åˆ™
- ç¡®è®¤åå‘ä»£ç†çš„ç›®æ ‡åœ°å€ä¸º `http://127.0.0.1:3002`ï¼ˆä¸åç«¯ç«¯å£ä¸€è‡´ï¼‰
- é‡è½½ Nginx å¹¶æ¸…ç©ºæµè§ˆå™¨ç¼“å­˜

**æ’æŸ¥æ­¥éª¤**ï¼š
1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰ï¼ŒæŸ¥çœ‹ Network æ ‡ç­¾
2. æ£€æŸ¥è¯·æ±‚çš„å®Œæ•´ URL æ˜¯å¦æ­£ç¡®
3. æ£€æŸ¥è¯·æ±‚æ˜¯å¦åˆ°è¾¾æœåŠ¡å™¨ï¼ˆæŸ¥çœ‹ Node é¡¹ç›®æ—¥å¿—ï¼‰
4. ç¡®è®¤åç«¯æœåŠ¡æ­£åœ¨è¿è¡Œï¼ˆè®¿é—® `/health` æ¥å£ï¼‰

### 7.4 å‰ç«¯é¡µé¢ç©ºç™½

**é—®é¢˜**ï¼šè®¿é—®åŸŸåæ˜¾ç¤ºç©ºç™½é¡µ

**åŸå› **ï¼šå‰ç«¯æ–‡ä»¶æœªæ­£ç¡®ä¸Šä¼ ï¼Œæˆ–è·¯å¾„é…ç½®é”™è¯¯

**è§£å†³æ–¹æ³•**ï¼š
1. ç¡®è®¤ç½‘ç«™æ ¹ç›®å½•åŒ…å« `index.html` å’Œ `assets/` æ–‡ä»¶å¤¹
2. æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰æ˜¯å¦æœ‰ 404 é”™è¯¯
3. ç¡®è®¤ Nginx ç«™ç‚¹çš„ **"ç½‘ç«™ç›®å½•"** é…ç½®æ­£ç¡®

### 7.5 SSL è¯ä¹¦ç”³è¯·å¤±è´¥

**é—®é¢˜**ï¼šLet's Encrypt è¯ä¹¦ç”³è¯·æŠ¥é”™

**è§£å†³æ–¹æ³•**ï¼š
1. ç¡®è®¤åŸŸåå·²æ­£ç¡®è§£æåˆ°æœåŠ¡å™¨ IPï¼ˆå¯ç”¨ `ping` å‘½ä»¤æµ‹è¯•ï¼‰
2. ç¡®è®¤ 80 ç«¯å£å¼€æ”¾ï¼ˆLet's Encrypt éªŒè¯éœ€è¦ï¼‰
3. ç­‰å¾… DNS å®Œå…¨ç”Ÿæ•ˆï¼ˆé€šå¸¸éœ€è¦ 10-30 åˆ†é’Ÿï¼‰

### 7.6 æ”¯ä»˜æ—¶æç¤º Stripe é”™è¯¯

**é—®é¢˜**ï¼šå‰ç«¯æ˜¾ç¤º "Invalid API Key" æˆ–ç±»ä¼¼é”™è¯¯

**åŸå› **ï¼š`.env` æ–‡ä»¶ä¸­çš„ `STRIPE_SECRET_KEY` é…ç½®é”™è¯¯

**è§£å†³æ–¹æ³•**ï¼š
1. æ£€æŸ¥ `.env` æ–‡ä»¶ä¸­çš„å¯†é’¥æ ¼å¼ï¼š
   - æµ‹è¯•ç¯å¢ƒï¼š`sk_test_...`
   - ç”Ÿäº§ç¯å¢ƒï¼š`sk_live_...`
2. ç¡®è®¤å¯†é’¥æ— å¤šä½™ç©ºæ ¼
3. é‡å¯ Node é¡¹ç›®ä½¿é…ç½®ç”Ÿæ•ˆ

---

## å…«ã€å®‰å…¨å»ºè®®

### 8.1 ä¿æŠ¤æ•æ„Ÿä¿¡æ¯

- **æ°¸è¿œä¸è¦**å°† `.env` æ–‡ä»¶æäº¤åˆ° Git ä»“åº“
- ç”Ÿäº§ç¯å¢ƒä½¿ç”¨ Stripe çš„ **live key**ï¼ˆ`sk_live_...`ï¼‰
- å®šæœŸåœ¨ Stripe Dashboard ä¸­è½®æ¢ API å¯†é’¥

### 8.2 å¯ç”¨ HTTPS

- **å¿…é¡»**ä½¿ç”¨ SSL è¯ä¹¦ï¼ˆLet's Encrypt å…è´¹ï¼‰
- å¯ç”¨ Nginx çš„ **"å¼ºåˆ¶HTTPS"**
- ç¡®ä¿å‰åç«¯éƒ½ä½¿ç”¨ HTTPS é€šä¿¡

### 8.3 é˜²ç«å¢™é…ç½®

åœ¨å®å¡” **"å®‰å…¨"** é¢æ¿ä¸­ï¼š
- **å¼€æ”¾ç«¯å£**ï¼š80ï¼ˆHTTPï¼‰ã€443ï¼ˆHTTPSï¼‰
- **å…³é—­ç«¯å£**ï¼š3002ï¼ˆNode.js åç«¯ä»…å…è®¸å†…éƒ¨è®¿é—®ï¼‰

### 8.4 æ—¥å¿—ç›‘æ§

- å®šæœŸæŸ¥çœ‹ Node é¡¹ç›®æ—¥å¿—ï¼ˆå®å¡”é¢æ¿ -> Nodeé¡¹ç›® -> æ—¥å¿—ï¼‰
- ç›‘æ§æœåŠ¡å™¨èµ„æºä½¿ç”¨æƒ…å†µ
- è®¾ç½® Stripe Webhook æ¥æ”¶æ”¯ä»˜çŠ¶æ€é€šçŸ¥ï¼ˆå¯é€‰ï¼‰

---

## ä¹ã€å®Œæ•´éƒ¨ç½²æ¸…å•

å‰ç«¯éƒ¨ç½²ï¼š
- [ ] æœ¬åœ°æ‰§è¡Œ `npm run build` ç”Ÿæˆ `dist` ç›®å½•
- [ ] åœ¨å®å¡”åˆ›å»ºå‰ç«¯ç½‘ç«™ï¼ˆæˆ–ä½¿ç”¨å·²æœ‰ç½‘ç«™ï¼‰
- [ ] ä¸Šä¼  `dist` ç›®å½•å†…å®¹åˆ°ç½‘ç«™æ ¹ç›®å½•
- [ ] é…ç½® SSL è¯ä¹¦ï¼ˆLet's Encryptï¼‰
- [ ] é…ç½® Nginx åå‘ä»£ç†ï¼ˆ`/api` å’Œ `/health` æŒ‡å‘åç«¯ï¼‰
- [ ] æµ‹è¯•å‰ç«¯é¡µé¢è®¿é—®

åç«¯éƒ¨ç½²ï¼š
- [ ] å®‰è£… Node.js å’Œ PM2 ç®¡ç†å™¨
- [ ] åˆ›å»ºåç«¯ç›®å½• `/www/wwwroot/stripe-payment-api/`
- [ ] ä¸Šä¼  `server.js`ã€`package.json` åˆ°åç«¯ç›®å½•
- [ ] åˆ›å»º `.env` æ–‡ä»¶å¹¶é…ç½® `STRIPE_SECRET_KEY` å’Œ `PORT`
- [ ] åœ¨å®å¡” Node é¡¹ç›®ç®¡ç†å™¨ä¸­æ·»åŠ é¡¹ç›®å¹¶å¯åŠ¨
- [ ] ï¼ˆå¯é€‰ï¼‰é…ç½®åç«¯ç‹¬ç«‹åŸŸåå’Œ SSL
- [ ] æµ‹è¯• `/health` API æ¥å£

æµ‹è¯•éªŒè¯ï¼š
- [ ] è®¿é—® `/health` ç«¯ç‚¹éªŒè¯åç«¯è¿è¡Œ
- [ ] è®¿é—®å‰ç«¯é¡µé¢éªŒè¯ç•Œé¢æ˜¾ç¤º
- [ ] ä½¿ç”¨ Stripe æµ‹è¯•å¡å®Œæˆå®Œæ•´æ”¯ä»˜æµç¨‹
- [ ] åœ¨ Stripe Dashboard ä¸­æŸ¥çœ‹æ”¯ä»˜è®°å½•

---

## åã€æ¶æ„è¯´æ˜

### 10.1 ä¸ºä»€ä¹ˆä¸éœ€è¦æ•°æ®åº“ï¼Ÿ

æœ¬æ–¹æ¡ˆé‡‡ç”¨**æ— çŠ¶æ€åç«¯**è®¾è®¡ï¼Œæ‰€æœ‰æ”¯ä»˜è®°å½•å’Œå®¢æˆ·ä¿¡æ¯éƒ½å­˜å‚¨åœ¨ **Stripe åå°**ï¼š

- âœ… **ç®€åŒ–éƒ¨ç½²**ï¼šæ— éœ€é…ç½®å’Œç»´æŠ¤ MySQL æ•°æ®åº“
- âœ… **é™ä½æˆæœ¬**ï¼šèŠ‚çœæ•°æ®åº“æœåŠ¡å™¨èµ„æº
- âœ… **æé«˜å®‰å…¨æ€§**ï¼šé¿å…æœ¬åœ°å­˜å‚¨æ•æ„Ÿæ”¯ä»˜ä¿¡æ¯
- âœ… **å®˜æ–¹è®°å½•**ï¼šStripe Dashboard æä¾›å®Œæ•´çš„æ”¯ä»˜ã€é€€æ¬¾ã€å®¢æˆ·ç®¡ç†åŠŸèƒ½

### 10.2 åç«¯èŒè´£

åç«¯ `api/server.js` çš„å”¯ä¸€èŒè´£ï¼š
1. æ¥æ”¶å‰ç«¯çš„æ”¯ä»˜è¯·æ±‚ï¼ˆé‡‘é¢ï¼‰
2. è°ƒç”¨ Stripe API åˆ›å»º PaymentIntent
3. è¿”å› `clientSecret` ç»™å‰ç«¯
4. ï¼ˆå¯é€‰ï¼‰æä¾›æ”¯ä»˜çŠ¶æ€æŸ¥è¯¢æ¥å£

### 10.3 æ•°æ®å­˜å‚¨ä½ç½®

| æ•°æ®ç±»å‹ | å­˜å‚¨ä½ç½® | è®¿é—®æ–¹å¼ |
|---------|---------|---------|
| æ”¯ä»˜è®°å½• | Stripe Dashboard | [https://dashboard.stripe.com/payments](https://dashboard.stripe.com/payments) |
| å®¢æˆ·ä¿¡æ¯ | Stripe Dashboard | [https://dashboard.stripe.com/customers](https://dashboard.stripe.com/customers) |
| é€€æ¬¾è®°å½• | Stripe Dashboard | [https://dashboard.stripe.com/refunds](https://dashboard.stripe.com/refunds) |

---

## åä¸€ã€æ”¯æŒä¸å¸®åŠ©

### 11.1 æ—¥å¿—æŸ¥çœ‹

- **Node é¡¹ç›®æ—¥å¿—**ï¼šå®å¡”é¢æ¿ -> Nodeé¡¹ç›® -> ç‚¹å‡»é¡¹ç›®çš„ "æ—¥å¿—" æŒ‰é’®
- **Nginx é”™è¯¯æ—¥å¿—**ï¼šå®å¡”é¢æ¿ -> ç½‘ç«™ -> ç‚¹å‡»ç«™ç‚¹çš„ "æ—¥å¿—" æŒ‰é’®
- **æµè§ˆå™¨æ§åˆ¶å°**ï¼šæŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ŒæŸ¥çœ‹ Console å’Œ Network æ ‡ç­¾

### 11.2 Stripe èµ„æº

- [Stripe å®˜æ–¹æ–‡æ¡£](https://stripe.com/docs)
- [Stripe API å‚è€ƒ](https://stripe.com/docs/api)
- [Stripe æµ‹è¯•å¡å·](https://stripe.com/docs/testing)

### 11.3 å®å¡”é¢æ¿

- [å®å¡”å®˜æ–¹æ–‡æ¡£](https://www.bt.cn/bbs/)
- [å®å¡”è®ºå›](https://www.bt.cn/bbs/forum-1-1.html)

---

**éƒ¨ç½²å®Œæˆï¼ç¥æ‚¨ä½¿ç”¨æ„‰å¿«ï¼** ğŸ‰
